# copybook-rs Enterprise Audit Configuration
# Regulatory compliance and enterprise governance settings

# General audit configuration
audit:
  enabled: true
  retention_period_years: 7  # SOX compliance requirement
  evidence_integrity_validation: true
  cryptographic_verification: true

  # Audit trail settings
  trail:
    capture_performance_metrics: true
    capture_system_configuration: true
    capture_environment_details: true
    capture_user_actions: false  # Not applicable for automated benchmarks

  # Evidence collection
  evidence:
    hash_algorithm: "SHA-256"
    include_metadata: true
    include_raw_data: true
    include_processed_results: true
    archive_to_history: true

# Regulatory compliance standards
compliance_standards:

  # Sarbanes-Oxley Act (SOX) compliance
  sox:
    enabled: true
    description: "Financial controls and data integrity requirements"
    requirements:
      data_integrity:
        zero_corruption_tolerance: true
        deterministic_processing: true
        complete_audit_trail: true

      financial_reporting:
        quarterly_compliance_reports: true
        executive_certification_required: false  # For IT performance metrics
        internal_controls_validation: true

      documentation:
        process_documentation_required: true
        change_management_tracking: true
        access_controls_documentation: true

  # Health Insurance Portability and Accountability Act (HIPAA)
  hipaa:
    enabled: true
    description: "Healthcare data processing performance requirements"
    requirements:
      phi_protection:
        secure_processing_validation: true
        access_logging: true
        breach_prevention_monitoring: true

      performance_standards:
        patient_data_processing_sla: "5 seconds"
        availability_requirement: "99.9%"
        disaster_recovery_rto: "4 hours"

      documentation:
        risk_assessment_required: true
        security_incident_reporting: true
        staff_training_documentation: false  # Not applicable for automated systems

  # Payment Card Industry Data Security Standard (PCI-DSS)
  pci_dss:
    enabled: true
    description: "Payment card data handling performance requirements"
    requirements:
      data_protection:
        cardholder_data_security: true
        secure_processing_validation: true
        vulnerability_management: true

      performance_standards:
        real_time_processing_requirement: "2 seconds"
        fraud_detection_latency: "500 milliseconds"
        system_availability: "99.95%"

      compliance_validation:
        quarterly_scans: true
        annual_assessment: true
        continuous_monitoring: true

  # General Data Protection Regulation (GDPR)
  gdpr:
    enabled: true
    description: "Data processing performance and privacy compliance"
    requirements:
      data_rights:
        data_portability_performance: "24 hours"
        right_to_erasure_performance: "72 hours"
        data_access_response_time: "1 month"

      processing_principles:
        data_minimization_validation: true
        purpose_limitation_compliance: true
        accuracy_maintenance: true

      technical_measures:
        pseudonymization_performance: true
        encryption_overhead_monitoring: true
        security_by_design_validation: true

  # Information Security Management (ISO 27001)
  iso_27001:
    enabled: true
    description: "Information security management performance metrics"
    requirements:
      security_controls:
        access_control_performance: true
        cryptography_performance_impact: true
        security_monitoring_overhead: "< 5%"

      risk_management:
        performance_risk_assessment: true
        incident_response_capability: "15 minutes"
        business_continuity_validation: true

      continuous_improvement:
        performance_trend_monitoring: true
        security_effectiveness_measurement: true
        management_review_metrics: true

# Audit reporting configuration
reporting:

  # Report generation settings
  generation:
    automated_scheduling: true
    real_time_monitoring: true
    exception_based_alerting: true

  # Report formats and distribution
  formats:
    html_executive_summary: true
    json_machine_readable: true
    pdf_formal_reports: false  # Requires additional dependencies
    csv_data_export: true

  # Stakeholder distribution
  distribution:
    executives: []  # Would be configured with email addresses
    compliance_officers: []
    technical_teams: []
    external_auditors: []  # For regulatory audits

  # Report frequency by stakeholder
  frequency:
    executive_summary: "monthly"
    compliance_dashboard: "weekly"
    technical_metrics: "daily"
    regulatory_reports: "quarterly"

# Performance monitoring for compliance
performance_monitoring:

  # Compliance-specific metrics
  metrics:
    data_processing_integrity:
      measurement: "error_rate_percentage"
      threshold: 0.0  # Zero tolerance for data corruption
      monitoring_frequency: "continuous"

    system_availability:
      measurement: "uptime_percentage"
      threshold: 99.9
      monitoring_frequency: "continuous"

    response_time_compliance:
      measurement: "p95_response_time_ms"
      threshold: 100
      monitoring_frequency: "per_benchmark"

    security_overhead:
      measurement: "performance_impact_percentage"
      threshold: 5.0
      monitoring_frequency: "per_benchmark"

  # Alerting for compliance violations
  alerting:
    immediate_notification:
      - "data_integrity_violation"
      - "security_breach_indicator"
      - "regulatory_threshold_exceeded"

    escalation_procedures:
      level_1: "technical_team"
      level_2: "compliance_officer"
      level_3: "executive_management"

    notification_channels:
      email: false  # Disabled by default
      slack: false  # Disabled by default
      pagerduty: false  # Disabled by default
      console_output: true

# Evidence and data retention
data_management:

  # Retention policies
  retention:
    performance_metrics: "7 years"  # SOX compliance
    audit_logs: "7 years"
    compliance_reports: "10 years"  # Extended for regulatory requirements
    security_incidents: "indefinite"

  # Archival and backup
  archival:
    automated_archival: true
    compression_enabled: true
    encryption_at_rest: true
    geographic_distribution: false  # Single location by default

  # Data integrity
  integrity:
    checksum_validation: true
    periodic_integrity_checks: true
    corruption_detection: true
    automatic_repair: false  # Manual verification required

# Integration with external systems
integrations:

  # Enterprise systems
  enterprise:
    identity_management: false  # Not required for automated benchmarks
    change_management: false
    incident_management: false
    asset_management: false

  # Regulatory systems
  regulatory:
    compliance_databases: false
    regulatory_reporting_systems: false
    audit_management_platforms: false

  # Security systems
  security:
    siem_integration: false
    vulnerability_scanners: false
    threat_intelligence: false
    security_orchestration: false

# Configuration validation
validation:
  schema_version: "1.0"
  last_updated: "2024-01-01T00:00:00Z"
  configuration_owner: "copybook-rs Engineering Team"
  approval_authority: "Enterprise Compliance Officer"

  # Configuration change tracking
  change_management:
    require_approval: true
    track_changes: true
    validate_compliance_impact: true
    document_rationale: true